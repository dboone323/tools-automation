<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quantum Workspace Agent Dashboard</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .dashboard-container {
        max-width: 1400px;
        margin: 0 auto;
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
      }

      .header h1 {
        color: white;
        font-size: 2.5rem;
        font-weight: 300;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .header .subtitle {
        color: rgba(255, 255, 255, 0.8);
        font-size: 1.1rem;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .stat-card h3 {
        color: #333;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 15px;
        opacity: 0.7;
      }

      .stat-value {
        font-size: 2.5rem;
        font-weight: 300;
        color: #667eea;
        margin-bottom: 5px;
      }

      .stat-label {
        color: #666;
        font-size: 0.9rem;
      }

      .main-content {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 30px;
      }

      .agents-section,
      .tasks-section {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .section-header {
        display: flex;
        justify-content: between;
        align-items: center;
        margin-bottom: 20px;
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 15px;
      }

      .section-header h2 {
        color: #333;
        font-size: 1.5rem;
        font-weight: 400;
      }

      .refresh-btn {
        background: #667eea;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: background 0.3s;
      }

      .refresh-btn:hover {
        background: #5a6fd8;
      }

      .agent-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 15px;
      }

      .agent-card {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 15px;
        transition: all 0.3s;
      }

      .agent-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      .agent-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }

      .agent-name {
        font-weight: 600;
        color: #333;
      }

      .agent-status {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .status-running {
        background: #d4edda;
        color: #155724;
      }

      .status-stopped {
        background: #f8d7da;
        color: #721c24;
      }

      .status-idle {
        background: #fff3cd;
        color: #856404;
      }

      .agent-pid {
        color: #666;
        font-size: 0.9rem;
      }

      .tasks-list {
        max-height: 500px;
        overflow-y: auto;
      }

      .task-item {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 10px;
        transition: all 0.3s;
      }

      .task-item:hover {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .task-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }

      .task-id {
        font-weight: 600;
        color: #333;
        font-size: 0.9rem;
      }

      .task-priority {
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 0.7rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .priority-high {
        background: #f8d7da;
        color: #721c24;
      }

      .priority-medium {
        background: #fff3cd;
        color: #856404;
      }

      .priority-low {
        background: #d1ecf1;
        color: #0c5460;
      }

      .task-description {
        color: #666;
        font-size: 0.9rem;
        margin-bottom: 8px;
      }

      .task-meta {
        display: flex;
        justify-content: space-between;
        font-size: 0.8rem;
        color: #888;
      }

      .task-status {
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 0.7rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .status-queued {
        background: #e2e3e5;
        color: #383d41;
      }

      .status-completed {
        background: #d4edda;
        color: #155724;
      }

      .status-failed {
        background: #f8d7da;
        color: #721c24;
      }

      .loading {
        text-align: center;
        padding: 40px;
        color: #666;
      }

      .error {
        background: #f8d7da;
        color: #721c24;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        border: 1px solid #f5c6cb;
      }

      .performance-section {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        margin-top: 30px;
      }

      .performance-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
      }

      .performance-card {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        transition: all 0.3s;
      }

      .performance-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      .performance-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #f0f0f0;
      }

      .performance-title {
        font-weight: 600;
        color: #333;
        font-size: 1.1rem;
      }

      .performance-time {
        color: #666;
        font-size: 0.9rem;
      }

      .performance-metrics {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      .metric-item {
        text-align: center;
      }

      .metric-value {
        font-size: 1.5rem;
        font-weight: 600;
        color: #667eea;
        margin-bottom: 5px;
      }

      .metric-label {
        color: #666;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .performance-trend {
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #f0f0f0;
      }

      .trend-indicator {
        display: flex;
        align-items: center;
        font-size: 0.9rem;
        color: #666;
      }

      .trend-up {
        color: #28a745;
      }

      .trend-down {
        color: #dc3545;
      }

      .trend-stable {
        color: #ffc107;
      }

      .execution-history-section {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        margin-top: 30px;
      }

      .execution-history-grid {
        display: grid;
        gap: 15px;
      }

      .execution-item {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        transition: all 0.3s;
      }

      .execution-item:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      .execution-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #f0f0f0;
      }

      .execution-title {
        font-weight: 600;
        color: #333;
        font-size: 1.1rem;
      }

      .execution-meta {
        display: flex;
        gap: 15px;
        font-size: 0.9rem;
        color: #666;
      }

      .execution-description {
        color: #666;
        margin-bottom: 15px;
        line-height: 1.4;
      }

      .execution-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
      }

      .execution-stat {
        text-align: center;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 6px;
      }

      .execution-stat-value {
        font-size: 1.2rem;
        font-weight: 600;
        color: #667eea;
        display: block;
      }

      .execution-stat-label {
        font-size: 0.8rem;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .execution-result {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .result-success {
        background: #d4edda;
        color: #155724;
      }

      .result-failed {
        background: #f8d7da;
        color: #721c24;
      }

      .execution-output {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 6px;
        font-size: 0.9rem;
        color: #666;
        margin-top: 10px;
        border-left: 4px solid #667eea;
      }

      .execution-summary {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
        border: 1px solid #e0e0e0;
      }

      .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
      }

      .summary-item {
        text-align: center;
      }

      .summary-value {
        font-size: 2rem;
        font-weight: 600;
        color: #667eea;
        display: block;
        margin-bottom: 5px;
      }

      .summary-label {
        color: #666;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .system-health-section {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        margin-top: 30px;
      }

      .health-overview {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .health-card {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        border: 2px solid transparent;
        transition: all 0.3s;
      }

      .health-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .health-card.healthy {
        border-color: #28a745;
        background: linear-gradient(135deg, #d4edda 0%, #f8f9fa 100%);
      }

      .health-card.warning {
        border-color: #ffc107;
        background: linear-gradient(135deg, #fff3cd 0%, #f8f9fa 100%);
      }

      .health-card.critical {
        border-color: #dc3545;
        background: linear-gradient(135deg, #f8d7da 0%, #f8f9fa 100%);
      }

      .health-value {
        font-size: 2rem;
        font-weight: 600;
        color: #333;
        margin-bottom: 5px;
      }

      .health-label {
        color: #666;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .health-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .health-detail-card {
        background: white;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        transition: all 0.3s;
      }

      .health-detail-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      .detail-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #f0f0f0;
      }

      .detail-title {
        font-weight: 600;
        color: #333;
        font-size: 1.1rem;
      }

      .detail-status {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .status-healthy {
        background: #d4edda;
        color: #155724;
      }

      .status-warning {
        background: #fff3cd;
        color: #856404;
      }

      .status-critical {
        background: #f8d7da;
        color: #721c24;
      }

      .detail-metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 15px;
      }

      .metric-item {
        text-align: center;
      }

      .metric-value {
        font-size: 1.2rem;
        font-weight: 600;
        color: #667eea;
        display: block;
        margin-bottom: 5px;
      }

      .metric-label {
        color: #666;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .services-grid {
        display: grid;
        gap: 10px;
        margin-top: 15px;
      }

      .service-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 6px;
        border: 1px solid #e0e0e0;
      }

      .service-name {
        font-weight: 500;
        color: #333;
      }

      .service-info {
        display: flex;
        gap: 15px;
        font-size: 0.9rem;
        color: #666;
      }

      .service-status {
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 0.7rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .service-running {
        background: #d4edda;
        color: #155724;
      }

      .service-failed {
        background: #f8d7da;
        color: #721c24;
      }

      .alerts-section {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        margin-top: 30px;
      }

      .alerts-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .alerts-title {
        font-size: 1.5rem;
        font-weight: 400;
        color: #333;
      }

      .alerts-summary {
        display: flex;
        gap: 20px;
        margin-bottom: 25px;
      }

      .alert-summary-item {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        min-width: 120px;
      }

      .alert-summary-value {
        font-size: 1.8rem;
        font-weight: 600;
        color: #667eea;
        display: block;
        margin-bottom: 5px;
      }

      .alert-summary-label {
        color: #666;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .alerts-tabs {
        display: flex;
        margin-bottom: 20px;
        border-bottom: 1px solid #e0e0e0;
      }

      .alert-tab {
        padding: 10px 20px;
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all 0.3s;
        font-weight: 500;
      }

      .alert-tab.active {
        border-bottom-color: #667eea;
        color: #667eea;
      }

      .alert-tab:hover {
        background: #f8f9fa;
      }

      .alerts-content {
        display: grid;
        gap: 15px;
      }

      .alert-item {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        transition: all 0.3s;
        position: relative;
      }

      .alert-item:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      .alert-item.critical {
        border-left: 4px solid #dc3545;
        background: linear-gradient(90deg, #f8d7da 0%, #ffffff 20%);
      }

      .alert-item.warning {
        border-left: 4px solid #ffc107;
        background: linear-gradient(90deg, #fff3cd 0%, #ffffff 20%);
      }

      .alert-item.info {
        border-left: 4px solid #17a2b8;
        background: linear-gradient(90deg, #d1ecf1 0%, #ffffff 20%);
      }

      .alert-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 10px;
      }

      .alert-title {
        font-weight: 600;
        color: #333;
        font-size: 1.1rem;
        margin-bottom: 5px;
      }

      .alert-meta {
        display: flex;
        gap: 15px;
        font-size: 0.9rem;
        color: #666;
      }

      .alert-description {
        color: #555;
        margin-bottom: 15px;
        line-height: 1.4;
      }

      .alert-actions {
        display: flex;
        gap: 10px;
        align-items: center;
      }

      .alert-severity {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .severity-critical {
        background: #f8d7da;
        color: #721c24;
      }

      .severity-warning {
        background: #fff3cd;
        color: #856404;
      }

      .severity-info {
        background: #d1ecf1;
        color: #0c5460;
      }

      .alert-resolve-btn {
        background: #28a745;
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.8rem;
        transition: background 0.3s;
      }

      .alert-resolve-btn:hover {
        background: #218838;
      }

      .alert-time {
        color: #888;
        font-size: 0.8rem;
      }

      .alert-category {
        display: inline-block;
        padding: 2px 8px;
        background: #e9ecef;
        border-radius: 12px;
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 10px;
      }

      .no-alerts {
        text-align: center;
        padding: 40px;
        color: #666;
      }

      .alerts-toggle {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 0.9rem;
        color: #666;
      }

      .alerts-toggle input[type="checkbox"] {
        width: 16px;
        height: 16px;
      }

      /* Alert Notifications Styles */
      .alerts-tabs {
        display: flex;
        margin-bottom: 20px;
        border-bottom: 1px solid #e0e0e0;
      }

      .alert-tab {
        padding: 10px 20px;
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all 0.3s;
        font-weight: 500;
        background: none;
        border: none;
        color: #666;
      }

      .alert-tab.active {
        border-bottom-color: #667eea;
        color: #667eea;
      }

      .alert-tab:hover {
        background: #f8f9fa;
        color: #333;
      }

      .alerts-tab-content {
        display: none;
      }

      .alerts-tab-content.active {
        display: block;
      }

      .alerts-summary {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        border: 1px solid #e0e0e0;
      }

      .alert-item {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 15px;
        transition: all 0.3s;
        position: relative;
        background: white;
      }

      .alert-item:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      .alert-item.critical {
        border-left: 4px solid #dc3545;
        background: linear-gradient(90deg, #f8d7da 0%, #ffffff 20%);
      }

      .alert-item.warning {
        border-left: 4px solid #ffc107;
        background: linear-gradient(90deg, #fff3cd 0%, #ffffff 20%);
      }

      .alert-item.info {
        border-left: 4px solid #17a2b8;
        background: linear-gradient(90deg, #d1ecf1 0%, #ffffff 20%);
      }

      .alert-item.resolved {
        opacity: 0.7;
        background: #f8f9fa;
      }

      .alert-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 10px;
      }

      .alert-title {
        font-weight: 600;
        color: #333;
        font-size: 1.1rem;
        margin-bottom: 5px;
      }

      .alert-severity {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
        text-transform: uppercase;
        white-space: nowrap;
      }

      .alert-severity.critical {
        background: #f8d7da;
        color: #721c24;
      }

      .alert-severity.warning {
        background: #fff3cd;
        color: #856404;
      }

      .alert-severity.info {
        background: #d1ecf1;
        color: #0c5460;
      }

      .alert-severity.resolved {
        background: #d4edda;
        color: #155724;
      }

      .alert-description {
        color: #555;
        margin-bottom: 15px;
        line-height: 1.4;
      }

      .alert-meta {
        display: flex;
        gap: 15px;
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 10px;
        flex-wrap: wrap;
      }

      .alert-recommendation {
        background: #e7f3ff;
        padding: 10px 15px;
        border-radius: 6px;
        border-left: 4px solid #667eea;
        font-size: 0.9rem;
        color: #333;
        margin-top: 10px;
      }

      .alert-category {
        display: inline-block;
        padding: 2px 8px;
        background: #e9ecef;
        border-radius: 12px;
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 10px;
      }

      .no-alerts {
        text-align: center;
        padding: 40px;
        color: #666;
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <div class="dashboard-container">
      <div class="header">
        <h1>üöÄ Quantum Workspace Agent Dashboard</h1>
        <div class="subtitle">
          Real-time monitoring of AI agents and task execution
        </div>
      </div>

      <div id="errorContainer"></div>

      <div class="stats-grid">
        <div class="stat-card">
          <h3>Total Agents</h3>
          <div class="stat-value" id="totalAgents">--</div>
          <div class="stat-label">Active AI assistants</div>
        </div>
        <div class="stat-card">
          <h3>Running Agents</h3>
          <div class="stat-value" id="runningAgents">--</div>
          <div class="stat-label">Currently active</div>
        </div>
        <div class="stat-card">
          <h3>Queued Tasks</h3>
          <div class="stat-value" id="queuedTasks">--</div>
          <div class="stat-label">Waiting for execution</div>
        </div>
        <div class="stat-card">
          <h3>Completed Tasks</h3>
          <div class="stat-value" id="completedTasks">--</div>
          <div class="stat-label">Successfully finished</div>
        </div>
        <div class="stat-card">
          <h3>System CPU</h3>
          <div class="stat-value" id="systemCpu">--%</div>
          <div class="stat-label">Current usage</div>
        </div>
        <div class="stat-card">
          <h3>System Memory</h3>
          <div class="stat-value" id="systemMemory">--MB</div>
          <div class="stat-label">Current usage</div>
        </div>
      </div>

      <div class="main-content">
        <div class="agents-section">
          <div class="section-header">
            <h2>ü§ñ Agent Status</h2>
            <button class="refresh-btn" onclick="loadDashboard()">
              Refresh
            </button>
          </div>
          <div id="agentsContainer">
            <div class="loading">Loading agent data...</div>
          </div>
        </div>

        <div class="tasks-section">
          <div class="section-header">
            <h2>üìã Task Queue</h2>
          </div>
          <div id="tasksContainer">
            <div class="loading">Loading task data...</div>
          </div>
        </div>
      </div>

      <div class="performance-section">
        <div class="section-header">
          <h2>üìä Performance Metrics</h2>
        </div>
        <div id="performanceContainer">
          <div class="loading">Loading performance data...</div>
        </div>
      </div>

      <div class="execution-history-section">
        <div class="section-header">
          <h2>üìà Task Execution History</h2>
        </div>
        <div id="executionHistoryContainer">
          <div class="loading">Loading execution history...</div>
        </div>
      </div>
    </div>

    <script>
      let agentData = {};
      let taskData = {};
      let performanceData = {};
      let executionHistoryData = {};
      let systemHealthData = {};

      // Load dashboard data on page load
      document.addEventListener("DOMContentLoaded", function () {
        loadDashboard();
        // Auto-refresh every 30 seconds
        setInterval(loadDashboard, 30000);
      });

      async function loadDashboard() {
        try {
          await Promise.all([
            loadAgentData(),
            loadTaskData(),
            loadPerformanceData(),
            loadExecutionHistoryData(),
            loadSystemHealthData(),
          ]);
          updateStats();
          updateAgentsDisplay();
          updateTasksDisplay();
          updatePerformanceDisplay();
          updateExecutionHistoryDisplay();
          updateSystemHealthDisplay();
          hideError();
        } catch (error) {
          console.error("Failed to load dashboard:", error);
          showError(
            "Failed to load dashboard data. Please check server connection.",
          );
        }
      }

      async function loadAgentData() {
        try {
          const response = await fetch("./Automation/agents/agent_status.json");
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          agentData = await response.json();
        } catch (error) {
          console.error("Failed to load agent data:", error);
          throw error;
        }
      }

      async function loadTaskData() {
        try {
          const response = await fetch("./Automation/agents/task_queue.json");
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          taskData = await response.json();
        } catch (error) {
          console.error("Failed to load task data:", error);
          throw error;
        }
      }

      async function loadPerformanceData() {
        try {
          const response = await fetch(
            "./Automation/agents/performance_metrics.json",
          );
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          performanceData = await response.json();
        } catch (error) {
          console.error("Failed to load performance data:", error);
          throw error;
        }
      }

      async function loadExecutionHistoryData() {
        try {
          const response = await fetch(
            "./Automation/agents/task_execution_history.json",
          );
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          executionHistoryData = await response.json();
        } catch (error) {
          console.error("Failed to load execution history data:", error);
          throw error;
        }
      }

      function updateStats() {
        const agents = agentData.agents || {};
        const tasks = taskData.tasks || [];
        const metrics = performanceData.metrics || [];

        // Agent stats
        const totalAgents = Object.keys(agents).length;
        const runningAgents = Object.values(agents).filter(
          (agent) => agent.status === "running",
        ).length;

        // Task stats
        const queuedTasks = tasks.filter(
          (task) => task.status === "queued",
        ).length;
        const completedTasks = tasks.filter(
          (task) => task.status === "completed",
        ).length;

        // System performance stats
        const latestMetrics =
          metrics.length > 0 ? metrics[metrics.length - 1] : null;

        document.getElementById("totalAgents").textContent = totalAgents;
        document.getElementById("runningAgents").textContent = runningAgents;
        document.getElementById("queuedTasks").textContent = queuedTasks;
        document.getElementById("completedTasks").textContent = completedTasks;

        if (latestMetrics) {
          document.getElementById("systemCpu").textContent =
            `${latestMetrics.cpu_usage}%`;
          document.getElementById("systemMemory").textContent =
            `${latestMetrics.memory_usage}%`;
        }
      }

      function updateAgentsDisplay() {
        const container = document.getElementById("agentsContainer");
        const agents = agentData.agents || {};

        if (Object.keys(agents).length === 0) {
          container.innerHTML = '<div class="loading">No agents found</div>';
          return;
        }

        const agentCards = Object.entries(agents)
          .map(([name, agent]) => {
            const statusClass = `status-${agent.status}`;
            return `
            <div class="agent-card">
              <div class="agent-header">
                <div class="agent-name">${formatAgentName(name)}</div>
                <div class="agent-status ${statusClass}">${agent.status}</div>
              </div>
              <div class="agent-pid">PID: ${agent.pid || "N/A"}</div>
            </div>
          `;
          })
          .join("");

        container.innerHTML = `<div class="agent-grid">${agentCards}</div>`;
      }

      function updateTasksDisplay() {
        const container = document.getElementById("tasksContainer");
        const tasks = taskData.tasks || [];

        if (tasks.length === 0) {
          container.innerHTML = '<div class="loading">No tasks found</div>';
          return;
        }

        // Show only the first 10 tasks to avoid overwhelming the UI
        const displayTasks = tasks.slice(0, 10);

        const taskItems = displayTasks
          .map((task) => {
            const priorityClass = getPriorityClass(task.priority);
            const statusClass = `status-${task.status}`;
            const createdDate = new Date(
              task.created * 1000,
            ).toLocaleDateString();

            return `
            <div class="task-item">
              <div class="task-header">
                <div class="task-id">${task.id}</div>
                <div class="task-priority ${priorityClass}">Priority ${task.priority}</div>
              </div>
              <div class="task-description">${task.description}</div>
              <div class="task-meta">
                <span>Type: ${task.type}</span>
                <span class="task-status ${statusClass}">${task.status}</span>
              </div>
              <div class="task-meta">
                <span>Agent: ${task.assigned_agent}</span>
                <span>Created: ${createdDate}</span>
              </div>
            </div>
          `;
          })
          .join("");

        container.innerHTML = `<div class="tasks-list">${taskItems}</div>`;
      }

      function updatePerformanceDisplay() {
        const container = document.getElementById("performanceContainer");
        const metrics = performanceData.metrics || [];

        if (metrics.length === 0) {
          container.innerHTML =
            '<div class="loading">No performance data available</div>';
          return;
        }

        // Get the latest metrics
        const latest = metrics[metrics.length - 1];
        const previous =
          metrics.length > 1 ? metrics[metrics.length - 2] : latest;

        const timestamp = new Date(
          parseInt(latest.timestamp) * 1000,
        ).toLocaleString();

        // Calculate trends
        const cpuTrend =
          parseFloat(latest.cpu_usage) - parseFloat(previous.cpu_usage);
        const memoryTrend =
          parseFloat(latest.memory_usage) - parseFloat(previous.memory_usage);

        const performanceCard = `
          <div class="performance-card">
            <div class="performance-header">
              <div class="performance-title">System Performance</div>
              <div class="performance-time">Last updated: ${timestamp}</div>
            </div>
            <div class="performance-metrics">
              <div class="metric-item">
                <div class="metric-value">${latest.cpu_usage}%</div>
                <div class="metric-label">CPU Usage</div>
              </div>
              <div class="metric-item">
                <div class="metric-value">${latest.memory_usage}%</div>
                <div class="metric-label">Memory Usage</div>
              </div>
              <div class="metric-item">
                <div class="metric-value">${latest.disk_usage}%</div>
                <div class="metric-label">Disk Usage</div>
              </div>
              <div class="metric-item">
                <div class="metric-value">${latest.agent_count.trim()}</div>
                <div class="metric-label">Active Agents</div>
              </div>
            </div>
            <div class="performance-trend">
              <div class="trend-indicator ${getTrendClass(cpuTrend)}">
                CPU: ${cpuTrend >= 0 ? "+" : ""}${cpuTrend.toFixed(1)}% ${getTrendIcon(cpuTrend)}
              </div>
              <div class="trend-indicator ${getTrendClass(memoryTrend)}">
                Memory: ${memoryTrend >= 0 ? "+" : ""}${memoryTrend.toFixed(1)}% ${getTrendIcon(memoryTrend)}
              </div>
            </div>
          </div>
        `;

        container.innerHTML = `<div class="performance-grid">${performanceCard}</div>`;
      }

      function updateExecutionHistoryDisplay() {
        const container = document.getElementById("executionHistoryContainer");
        const history = executionHistoryData.execution_history || [];
        const summary = executionHistoryData.summary || {};

        if (history.length === 0) {
          container.innerHTML =
            '<div class="loading">No execution history available</div>';
          return;
        }

        // Show summary first
        let html = `
          <div class="execution-summary">
            <div class="summary-grid">
              <div class="summary-item">
                <span class="summary-value">${summary.total_completed || 0}</span>
                <div class="summary-label">Total Completed</div>
              </div>
              <div class="summary-item">
                <span class="summary-value">${summary.success_rate || 0}%</span>
                <div class="summary-label">Success Rate</div>
              </div>
              <div class="summary-item">
                <span class="summary-value">${Math.round(summary.average_duration || 0)}s</span>
                <div class="summary-label">Avg Duration</div>
              </div>
              <div class="summary-item">
                <span class="summary-value">${summary.total_files_processed || 0}</span>
                <div class="summary-label">Files Processed</div>
              </div>
            </div>
          </div>
        `;

        // Show recent executions (last 5)
        const recentExecutions = history.slice(-5).reverse();

        const executionItems = recentExecutions
          .map((execution) => {
            const startedDate = new Date(
              execution.started * 1000,
            ).toLocaleString();
            const completedDate = new Date(
              execution.completed * 1000,
            ).toLocaleString();
            const duration = Math.round(execution.duration_seconds);
            const resultClass = `result-${execution.result}`;

            return `
            <div class="execution-item">
              <div class="execution-header">
                <div class="execution-title">${execution.task_id}</div>
                <div class="execution-meta">
                  <span>${execution.type}</span>
                  <span class="execution-result ${resultClass}">${execution.result}</span>
                </div>
              </div>
              <div class="execution-description">${execution.description}</div>
              <div class="execution-stats">
                <div class="execution-stat">
                  <span class="execution-stat-value">${duration}s</span>
                  <div class="execution-stat-label">Duration</div>
                </div>
                <div class="execution-stat">
                  <span class="execution-stat-value">${execution.files_processed || 0}</span>
                  <div class="execution-stat-label">Files</div>
                </div>
                <div class="execution-stat">
                  <span class="execution-stat-value">${execution.issues_found || 0}</span>
                  <div class="execution-stat-label">Issues</div>
                </div>
                <div class="execution-stat">
                  <span class="execution-stat-value">${execution.recommendations || 0}</span>
                  <div class="execution-stat-label">Recommendations</div>
                </div>
              </div>
              <div class="execution-meta">
                <span>Agent: ${execution.assigned_agent}</span>
                <span>Started: ${startedDate}</span>
                <span>Completed: ${completedDate}</span>
              </div>
              <div class="execution-output">
                ${execution.output}
              </div>
            </div>
          `;
          })
          .join("");

        html += `<div class="execution-history-grid">${executionItems}</div>`;

        container.innerHTML = html;
      }

      async function loadSystemHealthData() {
        try {
          const response = await fetch(
            "./Automation/agents/system_health.json",
          );
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          systemHealthData = await response.json();
        } catch (error) {
          console.error("Failed to load system health data:", error);
          throw error;
        }
      }

      function updateSystemHealthDisplay() {
        const container = document.getElementById("systemHealthContainer");
        const health = systemHealthData.system_health || {};

        if (!health || Object.keys(health).length === 0) {
          container.innerHTML =
            '<div class="loading">No system health data available</div>';
          return;
        }

        const overall = health.overall_health || {};
        const server = health.server_status || {};
        const disk = health.disk_usage || {};
        const memory = health.memory_status || {};

        // Overall health overview
        const overallStatusClass = `health-${overall.status || "unknown"}`;
        const serverStatusClass = `health-${server.status || "unknown"}`;
        const diskStatusClass = `health-${disk.status || "unknown"}`;
        const memoryStatusClass = `health-${memory.status || "unknown"}`;

        let html = `
          <div class="health-overview">
            <div class="health-card ${overallStatusClass}">
              <div class="health-value">${overall.score || 0}</div>
              <div class="health-label">Overall Health Score</div>
            </div>
            <div class="health-card ${serverStatusClass}">
              <div class="health-value">${server.response_time_ms || 0}ms</div>
              <div class="health-label">Server Response Time</div>
            </div>
            <div class="health-card ${diskStatusClass}">
              <div class="health-value">${disk.usage_percent || 0}%</div>
              <div class="health-label">Disk Usage</div>
            </div>
            <div class="health-card ${memoryStatusClass}">
              <div class="health-value">${memory.usage_percent || 0}%</div>
              <div class="health-label">Memory Usage</div>
            </div>
          </div>
        `;

        container.innerHTML = html;
      }

      function getTrendClass(value) {
        if (value > 5) return "trend-up";
        if (value < -5) return "trend-down";
        return "trend-stable";
      }

      function getTrendIcon(value) {
        if (value > 5) return "üìà";
        if (value < -5) return "üìâ";
        return "‚û°Ô∏è";
      }

      function formatAgentName(name) {
        return name.replace(/_/g, " ").replace(/\b\w/g, (l) => l.toUpperCase());
      }

      function getPriorityClass(priority) {
        if (priority >= 8) return "priority-high";
        if (priority >= 5) return "priority-medium";
        return "priority-low";
      }

      function showError(message) {
        const container = document.getElementById("errorContainer");
        container.innerHTML = `<div class="error">‚ö†Ô∏è ${message}</div>`;
      }

      function hideError() {
        document.getElementById("errorContainer").innerHTML = "";
      }

      // Handle page visibility changes to refresh data when tab becomes active
      document.addEventListener("visibilitychange", function () {
        if (!document.hidden) {
          loadDashboard();
        }
      });
    </script>

    <div class="system-health-section">
      <div class="section-header">
        <h2>ü©∫ System Health Indicators</h2>
      </div>
      <div id="systemHealthContainer">
        <div class="loading">Loading system health data...</div>
      </div>
    </div>

    <!-- Alert Notifications Section -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2>üö® Alert Notifications</h2>
      </div>
      <div id="alertsContainer">
        <div class="loading">Loading alert data...</div>
      </div>
    </div>
  </body>
</html>
